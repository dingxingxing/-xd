## 网络通讯原理

### 1、协议及协议栈的基本概念

#### 1.1、什么是协议

协议是网络中计算机或者设备之间进行通信的一系列规则的集合。常用协议有IP、TCP、HTTP、POP3、SMTP等。

#### 1.2、什么是协议栈

在网络中，为了完成通信，必须使用多层上的多种协议。这些协议按照层次顺序组合一起，构成了协议栈（Protocol Stack），也称为协议族（Protocol Suite）。

#### 1.3、协议的作用

一个网络协议的作用主要有两个：一是建立对等层直接的虚拟通讯，二是实现层次之间的无关性。

#### 1.4、层次的无关性

所谓层次间无关性，就是指较高层次和相邻的相低层次进行通讯时，只是利用较低层次提供的接口和服务，而不需了解底层实现该功能所采用的算法和协议的细节；较低层次也仅是使用从高层系统传送来的参数和控制信息，这就是层次间的无关性。

### 2、网络协议族/栈组成

网络通讯协议的作用是负责在网络上建立通信通道和控制通过通道的信息流规则。为了进行网络通讯，通信双方必须遵守通讯协议

![](D:\exces\文档存放区\Storage-of-record-documents\网络通讯原理\img\1597572319(1).jpg)



### 3、常见的网络协议

TCP/IP：工业标准、开放式协议，internet网络的标准

IPX/SPX：Novel开发的Netware操作系统使用的协议，IPX为网际数据包交换协议，工作早网络层，SPX为序列数据包交换协议，工作在传输层。

......

#### （1）TCP/IP协议

TCP/IP是分层协议，如层次图所示：从底层到应用层，分别是物理层，链路层，网络层，传输层，应用层。数据是层层封装，封装的方式一般都是在原有数据的前面加一个数据控制头。

![](D:\exces\文档存放区\Storage-of-record-documents\网络通讯原理\img\1597572956(1).jpg)

#### （2）Telnet协议

Telnet是TCP/IP中的一种应用协议，可以为终端仿真提供支持。可使用户连接到主机上，使主机响应起来就像它直接连接在终端上一样。Telnet在发送终端和接受端使用TCP的23号端口以进行专用的通信。

#### （3）FTP协议

FTP协议使用TCP20号和21号端口，20号端口用于数据交换，21号端口用于建立连接，允许目录和文件访问，上传下载，不能远程执行文件。

TFTP是简单文件传输协议（Trival File Trabsfer Protocol，TFTP），TFTP是无连接的，使用UDP的69号端口，用于当数据传输错误无关紧要而且无须安全性时的小型文件传输。

#### （4）DNS服务

DNS是域名解析服务（Domain Name Service，DNS）,作用是将域名转换为IP地址，或将IP地址转换为域名，用于解析完全合格域名。使用53号端口。

#### （5）DHCP服务

DHCP是动态主机配置协议(DHCP)，服务器可以提供的信息有：

1、IP地址

2、子网掩码

3、域名

4、默认网关

5、DNS



## HTTP协议

> BS/CS简述

BS：browser浏览器-server服务器

CS：client客户端-server服务器



### HTTP请求/响应的步骤：

​	**1、客户端连接到Web服务器**

一个HTTP客户端，通常是浏览器，与Web服务器的HTTP端口（默认为80）建立一个TCP套接连接。例如，http://www.oakcms.cn。

​	**2、发送HTTP请求**

通过TCP套接字，客户端向Web服务器发送一个文本的请求报文，一个请求报文由请求行、请求头部、空行和请求数据4部分组成。

​	**3、服务器接受请求并返回HTTP响应**

Web服务器解析请求，定位请求资源。分析请求链接，分析凭证，分析请求客户端，请求数据库获取相应的信息，最终按照HTTP协议进行响应。服务器将资源复本写到TCP套接字，由客户端读取。一个响应由状态行，响应头部、空行和响应数据4部分组成。

​	**4、释放连接TCP连接**

若connection模式为close，则服务器主动关闭TCP连接，客户端被动关闭链接，释放TCP链接；若connection模式为keepalive，则该连接会保持一段时间，在该时间内可以继续接收请求；

​	**5、客户端浏览器解析HTML内容**

客户端浏览器首先解析状态行，查看表明请求是否成功的状态码。然后解析每一个响应头，响应头告知若干字节的HTML文档和文档的字符集，客户端浏览器读取响应数据HTML，根据HTML的语法对其进行格式化，并在浏览器窗口中显示。



### 浏览器输入url地址到页面的渲染的整个过程：

1. 浏览器想DNS服务器请求解析该URL中的域名所对应的IP地址；
2. 解析出IP地址后，根据该IP地址个默认端口80，和服务器建立TCP连接；
3. 浏览器发出读取文件(URL中域名后面部分对应的文件)的HTTP请求，该请求报文作为TCP三次握手的第三个报文的数据发送给服务器；
4. 服务器独一浏览器请求作出响应，并把对应的html文本发送给浏览器；
5. 是否TCP连接；
6. 浏览器将该html文本显示内容，渲染DOM树，请求新链接；













